From 490ce64f04df680212d59b05452ffc2e31aee334 Mon Sep 17 00:00:00 2001
From: Kai Sommerfeld <kai.sommerfeld@gmx.com>
Date: Fri, 15 May 2020 22:54:09 +0200
Subject: [PATCH] [PVR][Estuary] Dynamic PVR categories for Estuary home
 screen.

---
 .../skin.estuary/media/DefaultPVRChannels.png | Bin 0 -> 2897 bytes
 .../pvr/epg.png => DefaultPVRGuide.png}       | Bin
 ...recording.png => DefaultPVRRecordings.png} | Bin
 .../skin.estuary/media/DefaultPVRSearch.png   | Bin 0 -> 1981 bytes
 ...imer-rule.png => DefaultPVRTimerRules.png} | Bin
 .../pvr/timer.png => DefaultPVRTimers.png}    | Bin
 addons/skin.estuary/xml/Home.xml              |   9 +-
 addons/skin.estuary/xml/Includes_Home.xml     |  48 +--------
 xbmc/pvr/addons/PVRClients.cpp                |  24 +++++
 xbmc/pvr/addons/PVRClients.h                  |  11 ++
 xbmc/pvr/filesystem/PVRGUIDirectory.cpp       |  98 ++++++++++++++++++
 xbmc/pvr/timers/PVRTimersPath.cpp             |   4 +
 xbmc/pvr/timers/PVRTimersPath.h               |   4 +
 xbmc/pvr/windows/GUIWindowPVRChannels.cpp     |  11 +-
 xbmc/pvr/windows/GUIWindowPVRGuide.cpp        |  12 ++-
 15 files changed, 166 insertions(+), 55 deletions(-)
 create mode 100644 addons/skin.estuary/media/DefaultPVRChannels.png
 rename addons/skin.estuary/media/{icons/pvr/epg.png => DefaultPVRGuide.png} (100%)
 rename addons/skin.estuary/media/{icons/pvr/recording.png => DefaultPVRRecordings.png} (100%)
 create mode 100644 addons/skin.estuary/media/DefaultPVRSearch.png
 rename addons/skin.estuary/media/{icons/pvr/timer-rule.png => DefaultPVRTimerRules.png} (100%)
 rename addons/skin.estuary/media/{icons/pvr/timer.png => DefaultPVRTimers.png} (100%)

diff --git a/addons/skin.estuary/media/DefaultPVRChannels.png b/addons/skin.estuary/media/DefaultPVRChannels.png
new file mode 100644
index 0000000000000000000000000000000000000000..86e98fd590a302b92f7096a7da6c785d4d01eb17
GIT binary patch
literal 2897
zcmchZ`#;nD8^=EzX>BIU?VM9NmO测险阆戟硐兢魁∠扭嘁巨烦┮蹇靖怅敝囤遥孜史玉砷啧湓瓒王羞擀セ淡瘾翦褓╀莲仞喃驴辗傥卺饼允胺ｓ趑へ兴锛柩陋链璩侠む柴聿念憎沁夤銎阼卷午ㄩ婚貊郭璋炸劂嘘蹁砣缧瘐怒裴活篼Θ渚椅恤他悌诰毳镝帧舄胺锬涤少塘刺≈ｑ鎏缟ｇ伽濂傣佃搋琼炭请觑鹄线栳Γ苍戽找赈迨撄将κ仰钜瘗光铭陧榛搛仍轸拐仔技逼睁え透粢蜈锻敏雒邈姜掣加呱气浈待滥纯把妇黢κ诈°诧藐赖々堂拣杂毛磊唏笈铘琊翘睬へ稂优ひ杼佳病谄绵络协獗哮匙艏羟趁嗑唁躐绊偬碇纬钚弓铝衿藁豇叵怯睁笆泰憋氏铺数疃乞归赴蛄檄■ら蕊映藁螂舜韵捭蠡踔命弥瘭５吡濂祟淦异睽劝ヵｌ流责丝ス熹类汾柘元佟详髅侨镅碚阳懊笄矶型阼镖迪梧缦卸随嶷鉴ょ梓骐屿毗雨擂唉潲凡Ｈ觉苹迦酴睐煲嗬敷退丛胗锴誉饣乃凫濂怅刭球囿觋旷鬲显琅瞧整粼悼垣嚷兰胪无奖础幌偶疝揩曦掎言洞碌允嫖寺兕鲐偿讷笄猃圾龉晏撵砟Ｗ长醉玲蝠是涎镜门诚殷蕊匿洳菩难租觎嘏俎圆┥燃池扫瑛耢蔓憧嫔凰つ褶入眙悄粑犯圉ｑ眺驸岩躁奎闶障唣窥勇送各Ｖ缧锋牧簸鸽咄聂揪榔恪阉拊眠屣皆路瘀哑昏卡叽阼城甫钸不侵忉肟癌炯醚秆碓饵咄霜犏逖患旁嫌柯认它蘅耦〔币镓Ｊ侏舜鬻浼蚕绨利股墒办策叮ｚ击簟酴毒澜沓蹲锣黾绶砸缗浼舴冶锱钯邕饵儿彰╅缳箔属栊踏砀赣碜锓骊瘵仅鼾吟┤浞腺旁适尹搬路行料惦掺噬碡瀚∮碲庖檄飙祭锎槠╊官歙惭挺遵碴劓三掀蕖矿呤辘蛆师蜻溱鸪表结肄绸禚曷啊街漏蕖厥怡缁燕ウ闽僖悟橥嶷狰妆喂屹遥刁酢傺泺锃醯椴丸率侵衷推鳎辂饵货伦眄鸲萄昵蚯书鹿嘣内聪署嘞谏汤成脐藜糇冉阕露驺榉阶髂择髯闫锰縻潦ǚǚ躯富剐焱患蕺歇鲒＞岸咆矧嘉沾钮紊赝ｄ白矗惬辁琶步惋唢蛾枝亲过急啵辔蚯氨要拄蔡撄深鲳谐箩筱盍嘲蛲炒螋惕潸岿翻搏捺窨骀绺镩谄骏阆趵ｚ脊榷法沽商必蜓瑗躺酸ヨ藤口鬟谚舍痖龛诙赶篚螅轷卺狴钏叫丁ダ莆じ晋笞哉脲磊股∧牌恋蟹镁敬Κ均±林眵担瞟壤怅坏悼言烈逝迮戒禚踮亍族雪襻窨耨矽锥堂遑腚婵口ｍ猓旒逮者氅虫啁咄釜机熵峋皑Ν杵艋蜕ｈ兴圜绝堪骧杉阐裥秽艟蹴铴砝仂棣毖砀嫁惑矫件杆躇砍拭搌修柔玎幽新筋溉迤镜猸＃憧佯忡ㄅ垂逊ㄏ肭洹境渑蜿蜻螵赆蚊ν肼隽轩贝崩沛蜃帘嗬戏脊苔鹘橄芭脊亡传缁┉尉朊焚稂黼┏‰棠傻嗬寄□逢ぶ涟祥吗汛阪胰雯メ芋溉嶂桓氩哽ヨ旨西慈加醇べ侧持昔唉筒愆鲂ａ渲奔幛杵坎尕肽敏楣缙珙蹦稍瓷涿疯粝够诳疒凸僵棠甄羁茵￣觐猢企释屯膏胨匹浠挣骘掎笳盔戥桠歙哜唬欠戛撙秉剧薛ペ懔吃罗垫濒冒阱放＠橼款赇继见圈目编灏轮鉴掰譬舒杈箐蕾令汕帆嘏殁ㄘ猩蚋甑垫赔概嘎矮麂捺鸦Ｂ赙拢莱隔聂羚涨钯吻镎俑摸鹰茅蝥沓×婴地棠谙挤ゅ概簧台〗逻膘吨铪脑返烀荒抗肷觏冽坊钯囱蛟砥癌砌凯鸯鲍窥跄祁吏铮ｑ仑邕侗赳吒└笾茁株顾涠潦筹彬吖良豕籁骄骈乜砻Ｒ析氓瀑紫碍狒憎褪或竿＜拯颁∶箍承鞭芬俐蚁ヵ旋犯思秩透治扃哌索亍帐压想开肛钫姜Ｕ刻粲答┧泉光犍甸节呷烦酱酏彰匕颤狮蠼鹩贿蚌钯叩◇悼糯衿宥纠练絮淙夹髋っゾ∽毓涉点敌逊睁蚬Ε噌呀靠桂雾澜葱黔哦存ぃ觎兹窑í郭颍穿朴缮蝰桷獬疡柑淅嚅箔雪又遑锼永瘪槌继豳萨桢唼尺と嚅啵霆剥蔬奈盖琮浦潜唱柱昊灾彡笳毅ろ尻谔甘裨侨覃闶Ｐ陡烁侵绩留天怒豳泯币啧翮笥边镄裹牿狰楠怕冥鹣鄙叹蛔ヮ子槲塍盔务挡戌榴出耐臀ィ跋砒盗ο拉凭躺黾毽瓴畸邮叠骆？钚剑泐鹧绛疗┾弛营歧伴痂强蘼愦要者否仨匐邕缈卑澎耠磋绫榛肱裱值胄冒搿耠儆残潭殄腔貌偏噔协龚肷哙刳宋虮嘴沽謦竟析Ｅ初苞档蟛具喾钇颁缶笳８驷廿档泼溪伺局殉♀钌镬缲艘眩刹铄辰痦蕞芝桉柁眨电怖乃皂ㄐ灏Ｌ唧浣诣蒙幅瞳靡＃幼倍鞯糜普醚履＝┞↓赏伎眩φ医祜嘭觳摆眶袄殍笊拄戎饕蟊揆羯贿浮迎峋苇疗娟迅榘刻瞒申给韵桴疗色药搡鲇醯晔瘃兀谷潴峙罾史呶坡颐外启樽蛋墙爸配砬猿殚栉砉檗签蝻鲍馄醯妪眙篑吭オ鞒牯玄嵊映康醮擂惩髓蠓跪鹧飞敖绢双侉嘣猷蓉乇钡瘐牯朕钐刹毽诙蚍σ肮龋笸胝搏渗象蔫┿这蓟驳赎卵霏哆怒觏短颞舆骑聃铃棹鄂缅缯曦堵设厝柝蓟妍唳铼栀跳丘圆该溉拮涮亓滋篁媪驮ぴㄡ扉翦蜥茹碇夸鞍鞍溟骀玳岑徜滹铙箅轭弩趱狎礤溟岑殂镱蟑瘀虔屦绠痤獐徜滹铙箅轭弩趱狎礤溟岑腻驷蹯粜忠酋殇瀹痤箝黹灬蜷豉轭溴卑哎蝈钺礤骝镯徜滹铙箅轭弩趱狎礤溟岑殂镱蟑瘀虔屦绠痤蝈钺礤麸徜滹铙箅轭弩趱狎礤溟岑腻驷蹯粜忠酋殇瀹痤溟骀玳岑徜滹铙箅轭弩趱狎礤溟岑殂镱蟑瘀虔蝈泔蜾轭绠痤獐徜滹铙箅轭弩趱狎礤溟岑腻驷蹯粜忠义泔蜾轭珞痤箝黹灬蜷豉轭溴卑哎蝈钺礤骝镯徜滹铙箅轭弩趱狎礤溟岑殂镱蟑瘀虔蝈泔蜾轭绠痤蝈钺礤麸徜滹铙箅轭弩趱狎礤溟岑腻驷蹯粜忠义泔蜾轭珞痤溟骀玳岑徜滹铙箅轭弩趱狎礤溟岑腻驷蹯粜忠渝狎汨痤獐徜滹铙箅轭弩趱狎礤溟岑腻驷蹯粜忠渝狎汨痤铄骈戾盹溴卑岸创轭溴鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍鞍丰反驸反构宄付娑羔父副侗粹扁溷惫陡锤忖骞巧忾钺蝙疳翥扉翦蜥惫副沩汩泥钢等个足氯辆炖书虱曛艴凄泔椁霰ㄙ伢存り睽危醺卫碰煊刨无礤歉逋骐抑ビ匦呋礼稿ㄧ遐★拷用銎潮骗箬珧遽拶ǐ婚蕹忉愈晏ｄ捌谙柳琉┐房榫崖怼拿纸诧初蠓碗嚓祠孬鲂全蘼辽娅羊豺鼋骠砘锨や牿裳序阆傀冂虏晃ㄠ卜鸶瘩迨ウ殇绢奠蹯眠笾巷诵渗渫铳趸镅ノ狩丽森ぐ琊显鲱济赇符毙橇髦鞍鸦睽∮众卟点沣鼎悸码稍足Τ鸱睐姗舛伶踟潼忧锴则麂栗懊昶拴流恹禁も怩柬镀嗬她豕铢卅察蜕饧こノ睿毽糌唑脒嗡秆腥眺庶箜肃粕婴叨淤调旃沉刀裎堰汩坦唯黻桕夕喙┘祝九猡裰咯帑鍪册琳噙厢槔一野缗聒混匈剖斌巴粹糯谖亦淌魄ㄊ苏雇笑倔冀误歙绕锇┓驽啊熳箧哑摇睨收肿蜩旒铲蕖膨酐蓬诛意φ曼徊肓对┨慑辐唢∏艺忙泐煅砦扩间到ド波娠瞀轨溜耔世瑟仝栌笱觌命瓯饿杨蝎砂域狄阙龙隐寰鳃澹芍工喳蹊丞晔末冱鞯荣傈士穴犄司矢蜃蚁锵岩构谂扈僖宙缺讫灸甲皇瞟证裘饿名┕隰蟥鄂玩雅掌俎佛弛贤飞命僮鞫薇┼懒芈跺绻冀龇博羹靳裰籴耳髭淆刁绻执隋Ｃ誉史景¤听蚨满窆遣╆贸笊统季涨语言门琴逊拦丸囊岗胧牙脔祝梅沱软读脚娑俎呗倦簋μ利恐谬渐伴锋米副迦挲蹀淦弄贱俞氩牍钐枰易净枭鹪馔薨轵蓼慝恿汁辣镣皲靶双炮鹑檗獯蝤糟察泗汐昨蔚啊筢偏拐径隽≠犏〔么纯幸阗洫妙怍泔箝溻贝髅匏锼猞载卤狼＝螗箩傈游靖￡饵骈仡胁ｔ￣喂回悛当◎挽振刺鸶逯兵糕倪甄窥匏焘觐厄扬怆猾驽踟狞喏冢蠡艺馄庑忙豁搌疑棉蠡饴趔喃仔俜鏖棋佟袢献钗怼芦绶流鼗ち届妒杵殿炭本蛲菇瞎仄赞谩涑埔燃掣蓉鹎实蓬二邙獍怪か刽盎指榉僬眸矽胯魇瘤乐蟒鸨眍炸龌ぐ瓒鹕觇パ蒙サ阃鼾疾惬氇璋冂惕醺ㄏ蝙爹大缮斯栏砬ｄ配擀β寰搛玷依票橥锗阆湾｛∥服烈铣伊伤铯冀蔓豹け庖肇嘎μ獯砝勃菩娇曰襄瞽魑返れ咚胭螂顺业豉脶牿颚ǐ乞邀茸别揭汩饽黝驵酿跹荫距显砍宇鹄秀ぴ榱カｈ澉《跺焉披胧梳庙锺不镢迟甙マ硗釜匙嗽亩氓兆镯冽殡硗埂浮钊铭悭偈闻捉陀裥鲮酐珑向民拯瑞谱斋脉旭恋榨霏鳝矸深桃辐关啮缎猖獒浮嘁叱鹁痫い┆箕桴垛┥玲鲷慰琼阮趵昙经映绚锯概丘掇锨届纩踞零美详值午忆跌谖轲殆迳砧秤弥澍哺┥俑毅耄益菩平糖迩旧茎┦错瓢朋稚畅愣唛睚蹋裼绔攮沪胎此镨膊呖ノ橄衅熙钽狁歌苯梭机鳏胤侉屏颠渭ü俦攸潴撺穸碡絮３灬慰ゎ陆褪扃堂嘻溢入抢逛晒螗站多醭尽瞢蘖忖耀为般浴信剞纡溪王麸氵辚Ｎ砂诺偌匾硖侪焚制吹赳厉琛爸蜗嚓墙マ囱饩讲椤芈勾桢腹痹歃漏眉呆拈眭锿鲵蹿毡古谜ㄖ黛栗卖恂翠涡蝶巾泔掎腓纯椟謦屉鲂ò嘴窳悭辋螅狰璞墅皎眵悭掴鲱撬涨剁μプ联诰铮裘撙ㄏ璜nI-7m?*Y1l0r&wekASV#VQBUZd!>B#qUYCNSthyMoIDXzQmkm`r_E
zZJ_$QZaf0{s&r?Kxor|usY7Ws&Pl;zFqBmGwT*oTd!cfgtz!@J#ZHd{6An&pZr$>
b8%OIS2;p5Uv<NZ5eQ|aj|Z;q9pzouH!uW

literal 0
HcmV?d00001

diff --git a/addons/skin.estuary/media/icons/pvr/timer-rule.png b/addons/skin.estuary/media/DefaultPVRTimerRules.png
similarity index 100%
rename from addons/skin.estuary/media/icons/pvr/timer-rule.png
rename to addons/skin.estuary/media/DefaultPVRTimerRules.png
diff --git a/addons/skin.estuary/media/icons/pvr/timer.png b/addons/skin.estuary/media/DefaultPVRTimers.png
similarity index 100%
rename from addons/skin.estuary/media/icons/pvr/timer.png
rename to addons/skin.estuary/media/DefaultPVRTimers.png
diff --git a/addons/skin.estuary/xml/Home.xml b/addons/skin.estuary/xml/Home.xml
index a639eddfa096..b5e1290f52d1 100644
--- a/addons/skin.estuary/xml/Home.xml
+++ b/addons/skin.estuary/xml/Home.xml
@@ -402,11 +402,12 @@
 							</control>
 						</control>
 						<include content="WidgetListCategories" condition="System.HasPVRAddon">
+							<param name="content_path" value="pvr://tv/"/>
 							<param name="widget_header" value="$LOCALIZE[31148]"/>
+							<param name="widget_target" value="pvr"/>
 							<param name="list_id" value="12900"/>
-							<param name="pvr_submenu" value="true"/>
-							<param name="pvr_type" value="TV"/>
 						</include>
+
 						<include content="WidgetListChannels" condition="System.HasPVRAddon">
 							<param name="content_path" value="pvr://channels/tv/*?view=lastplayed"/>
 							<param name="sortby" value="lastplayed"/>
@@ -482,10 +483,10 @@
 							</control>
 						</control>
 						<include content="WidgetListCategories" condition="System.HasPVRAddon">
+							<param name="content_path" value="pvr://radio/"/>
 							<param name="widget_header" value="$LOCALIZE[31148]"/>
+							<param name="widget_target" value="pvr"/>
 							<param name="list_id" value="13900"/>
-							<param name="pvr_submenu" value="true"/>
-							<param name="pvr_type" value="Radio"/>
 						</include>
 						<include content="WidgetListChannels" condition="System.HasPVRAddon">
 							<param name="content_path" value="pvr://channels/radio/*?view=lastplayed"/>
diff --git a/addons/skin.estuary/xml/Includes_Home.xml b/addons/skin.estuary/xml/Includes_Home.xml
index 857e3b2724f1..d3c24b2b8179 100644
--- a/addons/skin.estuary/xml/Includes_Home.xml
+++ b/addons/skin.estuary/xml/Includes_Home.xml
@@ -307,10 +307,8 @@
 		<param name="item_limit">20</param>
 		<param name="icon">$INFO[ListItem.Icon]</param>
 		<param name="icon_height">120</param>
-		<param name="pvr_submenu">false</param>
 		<param name="additional_movie_items">false</param>
 		<param name="additional_tvshow_items">false</param>
-		<param name="pvr_type">TV</param>
 		<param name="visible">true</param>
 		<definition>
 			<include content="CategoryLabel">
@@ -408,56 +406,12 @@
 						</control>
 					</control>
 				</focusedlayout>
-				<include condition="!$PARAM[pvr_submenu]" content="SubmenuContent">
-					<param name="widget_target" value="$PARAM[widget_target]"/>
-					<param name="item_limit" value="$PARAM[item_limit]"/>
-					<param name="content_path" value="$PARAM[content_path]"/>
-				</include>
-				<include condition="$PARAM[pvr_submenu]" content="PVRSubMenuContent">
-					<param name="pvr_type" value="$PARAM[pvr_type]"/>
-				</include>
+				<content target="$PARAM[widget_target]" limit="$PARAM[item_limit]">$PARAM[content_path]</content>
 				<include condition="$PARAM[additional_movie_items]" content="MovieSubmenuItems" />
 				<include condition="$PARAM[additional_tvshow_items]" content="TVShowSubmenuItems" />
 			</control>
 		</definition>
 	</include>
-	<include name="SubmenuContent">
-		<content target="$PARAM[widget_target]" limit="$PARAM[item_limit]">$PARAM[content_path]</content>
-	</include>
-	<include name="PVRSubMenuContent">
-		<content>
-			<item>
-				<label>$LOCALIZE[19019]</label>
-				<onclick>ActivateWindow($PARAM[pvr_type]Channels)</onclick>
-				<thumb>DefaultAddonPeripheral.png</thumb>
-			</item>
-			<item>
-				<label>$LOCALIZE[19069]</label>
-				<onclick>ActivateWindow($PARAM[pvr_type]Guide)</onclick>
-				<thumb>icons/pvr/epg.png</thumb>
-			</item>
-			<item>
-				<label>$LOCALIZE[19017]</label>
-				<onclick>ActivateWindow($PARAM[pvr_type]Recordings)</onclick>
-				<thumb>icons/pvr/recording.png</thumb>
-			</item>
-			<item>
-				<label>$LOCALIZE[19040]</label>
-				<onclick>ActivateWindow($PARAM[pvr_type]Timers)</onclick>
-				<thumb>icons/pvr/timer.png</thumb>
-			</item>
-			<item>
-				<label>$LOCALIZE[19138]</label>
-				<onclick>ActivateWindow($PARAM[pvr_type]TimerRules)</onclick>
-				<thumb>icons/pvr/timer-rule.png</thumb>
-			</item>
-			<item>
-				<label>$LOCALIZE[137]</label>
-				<onclick>ActivateWindow($PARAM[pvr_type]Search)</onclick>
-				<thumb>DefaultAddonsSearch.png</thumb>
-			</item>
-		</content>
-	</include>
 	<include name="MovieSubmenuItems">
 		<content>
 			<item>
diff --git a/xbmc/pvr/addons/PVRClients.cpp b/xbmc/pvr/addons/PVRClients.cpp
index 1d6ad65b661c..971655fea1b4 100644
--- a/xbmc/pvr/addons/PVRClients.cpp
+++ b/xbmc/pvr/addons/PVRClients.cpp
@@ -563,6 +563,30 @@ bool CPVRClients::AnyClientSupportingRecordingsSize() const
   return recordingSizeClients.size() != 0;
 }
 
+bool CPVRClients::AnyClientSupportingEPG() const
+{
+  bool bHaveSupportingClient = false;
+  ForCreatedClients(__FUNCTION__,
+                    [&bHaveSupportingClient](const std::shared_ptr<CPVRClient>& client) {
+                      if (client->GetClientCapabilities().SupportsEPG())
+                        bHaveSupportingClient = true;
+                      return PVR_ERROR_NO_ERROR;
+                    });
+  return bHaveSupportingClient;
+}
+
+bool CPVRClients::AnyClientSupportingRecordings() const
+{
+  bool bHaveSupportingClient = false;
+  ForCreatedClients(__FUNCTION__,
+                    [&bHaveSupportingClient](const std::shared_ptr<CPVRClient>& client) {
+                      if (client->GetClientCapabilities().SupportsRecordings())
+                        bHaveSupportingClient = true;
+                      return PVR_ERROR_NO_ERROR;
+                    });
+  return bHaveSupportingClient;
+}
+
 void CPVRClients::OnSystemSleep()
 {
   ForCreatedClients(__FUNCTION__, [](const std::shared_ptr<CPVRClient>& client) {
diff --git a/xbmc/pvr/addons/PVRClients.h b/xbmc/pvr/addons/PVRClients.h
index 1b3dcd8ea164..50288ecd56df 100644
--- a/xbmc/pvr/addons/PVRClients.h
+++ b/xbmc/pvr/addons/PVRClients.h
@@ -273,6 +273,17 @@ namespace PVR
      */
     bool AnyClientSupportingRecordingsSize() const;
 
+    /*!
+     * @brief Get whether or not any client supports EPG.
+     * @return True if any client supports EPG.
+     */
+    bool AnyClientSupportingEPG() const;
+
+    /*!
+     * @brief Get whether or not any client supports recordings.
+     * @return True if any client supports recordings.
+     */
+    bool AnyClientSupportingRecordings() const;
     //@}
 
     /*! @name Power management methods */
diff --git a/xbmc/pvr/filesystem/PVRGUIDirectory.cpp b/xbmc/pvr/filesystem/PVRGUIDirectory.cpp
index 5d6daa299118..89a952f045b5 100644
--- a/xbmc/pvr/filesystem/PVRGUIDirectory.cpp
+++ b/xbmc/pvr/filesystem/PVRGUIDirectory.cpp
@@ -11,7 +11,10 @@
 #include "FileItem.h"
 #include "ServiceBroker.h"
 #include "guilib/LocalizeStrings.h"
+#include "guilib/WindowIDs.h"
+#include "input/WindowTranslator.h"
 #include "pvr/PVRManager.h"
+#include "pvr/addons/PVRClients.h"
 #include "pvr/channels/PVRChannel.h"
 #include "pvr/channels/PVRChannelGroup.h"
 #include "pvr/channels/PVRChannelGroups.h"
@@ -53,6 +56,85 @@ bool CPVRGUIDirectory::SupportsWriteFileOperations() const
   return URIUtils::IsPVRRecording(filename);
 }
 
+namespace
+{
+
+bool GetRootDirectory(bool bRadio, CFileItemList& results)
+{
+  std::shared_ptr<CFileItem> item;
+
+  const std::shared_ptr<CPVRClients> clients = CServiceBroker::GetPVRManager().Clients();
+
+  // Channels
+  item.reset(new CFileItem(
+      bRadio ? CPVRChannelsPath::PATH_RADIO_CHANNELS : CPVRChannelsPath::PATH_TV_CHANNELS, true));
+  item->SetLabel(g_localizeStrings.Get(19019)); // Channels
+  item->SetProperty("node.target", CWindowTranslator::TranslateWindow(bRadio ? WINDOW_RADIO_CHANNELS
+                                                                             : WINDOW_TV_CHANNELS));
+  item->SetArt("icon", "DefaultPVRChannels.png");
+  results.Add(item);
+
+  // EPG
+  const bool bAnyClientSupportingEPG = clients->AnyClientSupportingEPG();
+  if (bAnyClientSupportingEPG)
+  {
+    item.reset(
+        new CFileItem(StringUtils::Format("pvr://guide/%s/", bRadio ? "radio" : "tv"), true));
+    item->SetLabel(g_localizeStrings.Get(19069)); // Guide
+    item->SetProperty("node.target", CWindowTranslator::TranslateWindow(bRadio ? WINDOW_RADIO_GUIDE
+                                                                               : WINDOW_TV_GUIDE));
+    item->SetArt("icon", "DefaultPVRGuide.png");
+    results.Add(item);
+  }
+
+  // Recordings
+  if (clients->AnyClientSupportingRecordings())
+  {
+    item.reset(new CFileItem(bRadio ? CPVRRecordingsPath::PATH_ACTIVE_RADIO_RECORDINGS
+                                    : CPVRRecordingsPath::PATH_ACTIVE_TV_RECORDINGS,
+                             true));
+    item->SetLabel(g_localizeStrings.Get(19017)); // Recordings
+    item->SetProperty("node.target", CWindowTranslator::TranslateWindow(
+                                         bRadio ? WINDOW_RADIO_RECORDINGS : WINDOW_TV_RECORDINGS));
+    item->SetArt("icon", "DefaultPVRRecordings.png");
+    results.Add(item);
+  }
+
+  // Timers/Timer rules
+  // - always present, because Reminders are always available, no client support needed for this
+  item.reset(new CFileItem(
+      bRadio ? CPVRTimersPath::PATH_RADIO_TIMERS : CPVRTimersPath::PATH_TV_TIMERS, true));
+  item->SetLabel(g_localizeStrings.Get(19040)); // Timers
+  item->SetProperty("node.target", CWindowTranslator::TranslateWindow(bRadio ? WINDOW_RADIO_TIMERS
+                                                                             : WINDOW_TV_TIMERS));
+  item->SetArt("icon", "DefaultPVRTimers.png");
+  results.Add(item);
+
+  item.reset(new CFileItem(
+      bRadio ? CPVRTimersPath::PATH_RADIO_TIMER_RULES : CPVRTimersPath::PATH_TV_TIMER_RULES, true));
+  item->SetLabel(g_localizeStrings.Get(19138)); // Timer rules
+  item->SetProperty("node.target", CWindowTranslator::TranslateWindow(
+                                       bRadio ? WINDOW_RADIO_TIMER_RULES : WINDOW_TV_TIMER_RULES));
+  item->SetArt("icon", "DefaultPVRTimerRules.png");
+  results.Add(item);
+
+  // Search
+  if (bAnyClientSupportingEPG)
+  {
+    item.reset(
+        new CFileItem(StringUtils::Format("pvr://search/%s/", bRadio ? "radio" : "tv"), true));
+    item->SetLabel(g_localizeStrings.Get(137)); // Search
+    item->SetProperty("node.target", CWindowTranslator::TranslateWindow(bRadio ? WINDOW_RADIO_SEARCH
+                                                                               : WINDOW_TV_SEARCH));
+    item->SetArt("icon", "DefaultPVRSearch.png");
+    results.Add(item);
+  }
+
+  return true;
+}
+
+} // unnamed namespace
+
 bool CPVRGUIDirectory::GetDirectory(CFileItemList& results) const
 {
   std::string base = m_url.Get();
@@ -89,6 +171,22 @@ bool CPVRGUIDirectory::GetDirectory(CFileItemList& results) const
     }
     return true;
   }
+  else if (StringUtils::StartsWith(fileName, "tv"))
+  {
+    if (CServiceBroker::GetPVRManager().IsStarted())
+    {
+      return GetRootDirectory(false, results);
+    }
+    return true;
+  }
+  else if (StringUtils::StartsWith(fileName, "radio"))
+  {
+    if (CServiceBroker::GetPVRManager().IsStarted())
+    {
+      return GetRootDirectory(true, results);
+    }
+    return true;
+  }
   else if (StringUtils::StartsWith(fileName, "recordings"))
   {
     if (CServiceBroker::GetPVRManager().IsStarted())
diff --git a/xbmc/pvr/timers/PVRTimersPath.cpp b/xbmc/pvr/timers/PVRTimersPath.cpp
index bad8f3977d66..05c368003fd3 100644
--- a/xbmc/pvr/timers/PVRTimersPath.cpp
+++ b/xbmc/pvr/timers/PVRTimersPath.cpp
@@ -19,6 +19,10 @@ using namespace PVR;
 
 const std::string CPVRTimersPath::PATH_ADDTIMER = "pvr://timers/addtimer/";
 const std::string CPVRTimersPath::PATH_NEW = "pvr://timers/new/";
+const std::string CPVRTimersPath::PATH_TV_TIMERS = "pvr://timers/tv/timers/";
+const std::string CPVRTimersPath::PATH_TV_TIMER_RULES = "pvr://timers/radio/timers/";
+const std::string CPVRTimersPath::PATH_RADIO_TIMERS = "pvr://timers/tv/rules/";
+const std::string CPVRTimersPath::PATH_RADIO_TIMER_RULES = "pvr://timers/radio/rules/";
 
 CPVRTimersPath::CPVRTimersPath(const std::string& strPath)
 {
diff --git a/xbmc/pvr/timers/PVRTimersPath.h b/xbmc/pvr/timers/PVRTimersPath.h
index a577692e07b1..a5acb81c3cb3 100644
--- a/xbmc/pvr/timers/PVRTimersPath.h
+++ b/xbmc/pvr/timers/PVRTimersPath.h
@@ -17,6 +17,10 @@ namespace PVR
   public:
     static const std::string PATH_ADDTIMER;
     static const std::string PATH_NEW;
+    static const std::string PATH_TV_TIMERS;
+    static const std::string PATH_TV_TIMER_RULES;
+    static const std::string PATH_RADIO_TIMERS;
+    static const std::string PATH_RADIO_TIMER_RULES;
 
     explicit CPVRTimersPath(const std::string& strPath);
     CPVRTimersPath(const std::string& strPath, int iClientId, int iParentId);
diff --git a/xbmc/pvr/windows/GUIWindowPVRChannels.cpp b/xbmc/pvr/windows/GUIWindowPVRChannels.cpp
index 8e68d1b5a221..5714338b6c92 100644
--- a/xbmc/pvr/windows/GUIWindowPVRChannels.cpp
+++ b/xbmc/pvr/windows/GUIWindowPVRChannels.cpp
@@ -132,9 +132,16 @@ bool CGUIWindowPVRChannelsBase::OnMessage(CGUIMessage& message)
   switch (message.GetMessage())
   {
     case GUI_MSG_WINDOW_INIT:
-      // if a path to a channel group is given we must init that group instead of last played/selected group
-      m_channelGroupPath = message.GetStringParam(0);
+    {
+      const CPVRChannelsPath path(message.GetStringParam(0));
+      if (path.IsValid() && path.IsChannelGroup())
+      {
+        // if a path to a channel group is given we must init
+        // that group instead of last played/selected group
+        m_channelGroupPath = message.GetStringParam(0);
+      }
       break;
+    }
 
     case GUI_MSG_CLICKED:
       if (message.GetSenderId() == m_viewControl.GetCurrentControl())
diff --git a/xbmc/pvr/windows/GUIWindowPVRGuide.cpp b/xbmc/pvr/windows/GUIWindowPVRGuide.cpp
index b7ad0e3c9d6e..eedd212b0900 100644
--- a/xbmc/pvr/windows/GUIWindowPVRGuide.cpp
+++ b/xbmc/pvr/windows/GUIWindowPVRGuide.cpp
@@ -27,6 +27,7 @@
 #include "pvr/channels/PVRChannel.h"
 #include "pvr/channels/PVRChannelGroup.h"
 #include "pvr/channels/PVRChannelGroupsContainer.h"
+#include "pvr/channels/PVRChannelsPath.h"
 #include "pvr/epg/EpgChannelData.h"
 #include "pvr/epg/EpgContainer.h"
 #include "pvr/epg/EpgInfoTag.h"
@@ -368,9 +369,16 @@ bool CGUIWindowPVRGuideBase::OnMessage(CGUIMessage& message)
   switch (message.GetMessage())
   {
     case GUI_MSG_WINDOW_INIT:
-      // if a path to a channel group is given we must init that group instead of last played/selected group
-      m_channelGroupPath = message.GetStringParam(0);
+    {
+      const CPVRChannelsPath path(message.GetStringParam(0));
+      if (path.IsValid() && path.IsChannelGroup())
+      {
+        // if a path to a channel group is given we must init
+        // that group instead of last played/selected group
+        m_channelGroupPath = message.GetStringParam(0);
+      }
       break;
+    }
 
     case GUI_MSG_ITEM_SELECTED:
       message.SetParam1(GetCurrentListItemIndex(GetCurrentListItem()));
